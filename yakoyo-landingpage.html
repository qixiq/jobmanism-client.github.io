<html>
<head>
    <script type="text/javascript" src="jobmanapi.js"></script>
    <title>Yakoyo Main Page</title>
    <script>
        var sessionId = getQueryParameter('sessionId');
        var privileges = parseInt(getQueryParameter('privileges'));
        var userId = getQueryParameter('userId');
        var userName = getQueryParameter('userName');
        var itemsCount = 0;

        function onGotDigitalAssetTypes(data){ 
            itemsCount = 0; 
            document.getElementById('itemsList').innerHTML += "<p><strong>DIGITAL ASSET TYPES</strong></p><br/><br/>"; 
            data.assetTypes.forEach(appendDigitalAssetType);   
            document.getElementById('itemsList').innerHTML += '<br/><br/><button onclick="addDigitalAssetType()">Add New Digital Asset Type ... </button><br /><br /> ';

        }


        function onGotMenuItemCategories(data){

            itemsCount = 0; 
            document.getElementById('itemsList').innerHTML += "<p><strong>MENU ITEM CATEGORIES</strong></p><br/><br/>"; 
            data.items.forEach(appendMenuItemCategory);   
            document.getElementById('itemsList').innerHTML += '<br/><br/><button onclick="addNewMenuItemCategory()">Add New Menu Item Category ... </button><br /><br /> ';

            if((privileges & 1) != 0 || (privileges & 8) != 0)
            {
                //get digital Asset Types
                getDigitalAssetTypes(onGotDigitalAssetTypes, onError); 
            }
            
        }

        function onGotFoodAndDrinkVendorTypes(data)
        {
            itemsCount = 0; 
            document.getElementById('itemsList').innerHTML += "<p><strong>FOOD AND DRINK VENDOR TYPES</strong></p><br/><br/>"; 
            data.items.forEach(appendFoodAndDrinkVendorType);  
            document.getElementById('itemsList').innerHTML += '<br/><br/><button onclick="addNewFoodAndDrinkVendorType()">Add New Food And Drink Vendor Type ... </button><br /><br /> ';
            getMenuItemCategories(onGotMenuItemCategories, onError);
        }

        function onGotBusinesses(data) {
            addSearchButton();
            document.getElementById('itemsList').innerHTML += "<p><strong>VENDOR BUSINESSES</strong></p><br/><br/>"; 
            data.items.forEach(appendBusiness);  

            document.getElementById('itemsList').innerHTML += '<button onclick="addNewVendorBusiness()">Add New Vendor Business ... </button><br /><br /> ';

            if((privileges & 1) != 0 || (privileges & 8) != 0)
            {
                //get vendorTypes
                getFoodAndDrinkVendorTypes(onGotFoodAndDrinkVendorTypes, onError); 
            } 
        }

        function addSearchButton(){

            document.getElementById('itemsList').innerHTML = '<br/><br/><button onclick="openSearchPage()">Search ... </button><br /><br /> ';
        }

        function openSearchPage() {
            document.location.href = getPathPrefix(document.location.href) + '/yakoyo-search.html?sessionId=' + sessionId +   '&privileges=' + privileges;
        }



        function editBusiness(id) {
            document.location.href = getPathPrefix(document.location.href) + '/manage-vendor-business.html?sessionId=' + sessionId + '&businessId=' + id + '&privileges=' + privileges;
        }

        function onRemoveBusiness(id) {
            removeBusiness(sessionId, id, init, onError);
        }


        function editMenuItemCategory(id) {
            document.location.href = getPathPrefix(document.location.href) + '/manage-menu-item-category.html?sessionId=' + sessionId + '&menuItemCategoryId=' + id+ '&privileges=' + privileges;
        }

        function onRemoveMenuItemCategory(id) {
            removeMenuItemCategory(sessionId, id, init, onError);
        }

        function editFoodAndDrinkVendorType(id) {
            document.location.href = getPathPrefix(document.location.href) + '/manage-food-and-drink-vendor-type.html?sessionId=' + sessionId + '&vendorTypeId=' + id+ '&privileges=' + privileges;
        }

        function onRemoveFoodAndDrinkVendorType(id) {
            removeFoodAndDrinkVendorType(sessionId, id, init, onError);
        }

        function editDigitalAssetType(id) {
            document.location.href = getPathPrefix(document.location.href) + '/manage-digital-asset-type.html?sessionId=' + sessionId + '&typeId=' + id+ '&privileges=' + privileges;
        }

        function onRemoveDigitalAssetType(id) {
            removeDigitalAssetType(sessionId, id, init, onError);
        }

        function appendFoodAndDrinkVendorType(item){
            itemsCount++;
            var listDiv = document.getElementById('itemsList');
            listDiv.innerHTML += '<p><strong>FOOD AND DRINK VENDOR TYPE ' + itemsCount;
            listDiv.innerHTML += '</strong ></p>';
            listDiv.innerHTML += '<label>Name: ' + item.name + '</label><br/>';
            listDiv.innerHTML += '<p>' + item.description + '</p><br/>';
            listDiv.innerHTML += '<button  onclick="onRemoveFoodAndDrinkVendorType(\'' + item.id + '\')">Remove</button>&nbsp;&nbsp;';
            listDiv.innerHTML += '<button  onclick = "editFoodAndDrinkVendorType(\'' + item.id + '\')" >Manage ... </button >&nbsp;&nbsp;';
        }

        function appendMenuItemCategory(item){
            itemsCount++;
            var listDiv = document.getElementById('itemsList');
            listDiv.innerHTML += '<p><strong>MENU ITEM CATEGORY ' + itemsCount;
            listDiv.innerHTML += '</strong ></p>';
            listDiv.innerHTML += '<label>Name: ' + item.name + '</label><br/>';
            listDiv.innerHTML += '<p>' + item.description + '</p><br/>';
            listDiv.innerHTML += '<button  onclick="onRemoveMenuItemCategory(\'' + item.id + '\')">Remove</button>&nbsp;&nbsp;';
            listDiv.innerHTML += '<button  onclick = "editMenuItemCategory(\'' + item.id + '\')" >Manage ... </button >&nbsp;&nbsp;';
        }

        function appendDigitalAssetType(item){
            itemsCount++;
            var listDiv = document.getElementById('itemsList');
            listDiv.innerHTML += '<p><strong>DIGITAL ASSET TYPE ' + itemsCount;
            listDiv.innerHTML += '</strong ></p>';
            listDiv.innerHTML += '<label>Name: ' + item.name + '</label><br/>';
            listDiv.innerHTML += '<p>' + item.description + '</p><br/>';
            if(item.iconResourceId > 0)
            {
                listDiv.innerHTML += '<img  src="'+ getResourceUrl(item.iconResourceId) +'"</img><br/>';
            }
            
            listDiv.innerHTML += '<button  onclick="onRemoveDigitalAssetType(\'' + item.digitalAssetTypeId + '\')">Remove</button>&nbsp;&nbsp;';
            listDiv.innerHTML += '<button  onclick = "editDigitalAssetType(\'' + item.digitalAssetTypeId + '\')" >Manage ... </button >&nbsp;&nbsp;';
        }

        function appendBusiness(item) {
            itemsCount++;
            var listDiv = document.getElementById('itemsList');
            listDiv.innerHTML += '<p><strong>VENDOR BUSINESS ' + itemsCount;
            listDiv.innerHTML += '</strong ></p>';
            listDiv.innerHTML += '<label>Name: ' + item.name + '</label><br/>';
            listDiv.innerHTML += '<p>' + item.description + '</p><br/>';
            listDiv.innerHTML += '<button  onclick="onRemoveBusiness(\'' + item.id + '\')">Remove</button>&nbsp;&nbsp;';
            listDiv.innerHTML += '<button  onclick = "editBusiness(\'' + item.id + '\')" >Manage ... </button >&nbsp;&nbsp;';
        }



        function onError(details) {

        }

        function addNewVendorBusiness() {
            document.location.href = getPathPrefix(document.location.href) + '/add-business-object.html?sessionId=' + sessionId + '&objectType=Business&privileges=' + privileges;
        }
        function addNewFoodAndDrinkVendorType() {
            document.location.href = getPathPrefix(document.location.href) + '/add-business-object.html?sessionId=' + sessionId + '&objectType=FoodAndDrinkVendorType&privileges=' + privileges;
        }

        function addNewMenuItemCategory() {
            document.location.href = getPathPrefix(document.location.href) + '/add-business-object.html?sessionId=' + sessionId + '&objectType=MenuItemCategory&privileges=' + privileges;
        }

        function addDigitalAssetType() {
            document.location.href = getPathPrefix(document.location.href) + '/add-digital-asset-type.html?sessionId=' + sessionId + '&privileges=' + privileges;
        }

        function init() {
            getBusinesses('', onGotBusinesses, onError);
        }

        window.addEventListener('load', init);</script>
</head>
<body>
    <img width="200" height="200" src="YAKOYO-logo.jpg"></img> <br/><br/>
    <br /><br />
    <div id="itemsList">

    </div> 

</body>
</html>