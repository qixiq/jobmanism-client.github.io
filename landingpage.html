<html>
<head>
    <script type="text/javascript" src="jobmanapi.js"></script>
    <title>Jobman Landing Page</title>
    <script>

        var primaryPhoneNumberId = 0;
        var primaryAddressId = 0;
        var primaryPictureId = 0;
        var userId = 0;
        var userName = '';
        var sessionId = '';
        var isSuperAdmin = false;

        function onSuccess(data) {
            isSuperAdmin = data.privileges == 1;
            document.getElementById('userName').textContent = data.userName;
            userName = data.userName;
            userId = data.userId;
         
            document.getElementById('firstName').value = data.userNames.firstName;
            document.getElementById('middleNames').value = data.userNames.middleNames;
            document.getElementById('lastName').value = data.userNames.lastName;
     
            document.getElementById('street-1').value = data.address.streetLine1;
            document.getElementById('street-2').value = data.address.streetLine2;
            document.getElementById('street-number').value = data.address.streetNumber;
            document.getElementById('addr-city').value = data.address.city;
            document.getElementById('addr-state').value = data.address.state;
            document.getElementById('addr-country').value = data.address.country;
            document.getElementById('addr-gps').value = data.address.gpsLocation;
            document.getElementById('addr-post-code').value = data.address.postalCode;
            primaryAddressId = data.address.addressId;
         
            document.getElementById('phone-ctry-code').value = data.phoneNumber.countryCode;
            document.getElementById('phone-number').value = data.phoneNumber.numberText;
            document.getElementById('phone-features').value = data.phoneNumber.features;
            document.getElementById('phone-type').value = data.phoneNumber.type;
            primaryPhoneNumberId = data.phoneNumber.phoneNumberId;
            
            document.getElementById('current-picture').src = getResourceUrl(data.currentPictureId);
            primaryPictureId = data.currentPictureId;

            var query = document.location.search;
            const urlParams = new URLSearchParams(query);
            sessionId = urlParams.get('sessionId');

        }

        function manageAddresses() {
            document.location.href = getPathPrefix(document.location.href) + '/manage-addresses.html?sessionId=' + sessionId + '&userName=' + userName + '&primaryId=' + primaryAddressId;
        }

        function managePhoneNumbers() {
            document.location.href = getPathPrefix(document.location.href) + '/manage-phones.html?sessionId=' + sessionId + '&userName=' + userName + '&primaryId=' + primaryPhoneNumberId;
        }

        function managePictures() {
            document.location.href = getPathPrefix(document.location.href) + '/manage-pictures.html?sessionId=' + sessionId + '&userName=' + userName + '&primaryId=' + primaryPictureId;
        }

        function manageServiceCategories() {
            if (isSuperAdmin)
                document.location.href = getPathPrefix(document.location.href) + '/manage-service-categories.html?sessionId=' + sessionId;
            else
                document.location.href = getPathPrefix(document.location.href) + '/manage-my-services.html?sessionId=' + sessionId + '&userName=' + userName;
        }

        function onError(details) {

        }

        function init() {
            getUserProfile(onSuccess, onError)
        }

        window.addEventListener('load', init);
    </script>
</head>
<body>
    <form id="theForm">
        <p><strong>USER PROFILE</strong> for <span id="userName"></span></p><br />
        <label><strong>First Name :&nbsp;</strong></label><input id="firstName" type="text" /><br /><br />
        <label><strong>Middle Names :&nbsp;</strong></label><input id="middleNames" type="text" /><br /><br />
        <label><strong>Last Name:&nbsp;</strong></label><input id="lastName" type="text" /><br /><br />
        <button type="submit">Update My Names</button><br />
    </form>
    <div>
        <label><strong>Primary Address:&nbsp;</strong></label><button onclick="manageAddresses()">Manage Addresses</button><br /><br /><br /><br />
        <label>&nbsp;&nbsp;&nbsp;Street Line1:&nbsp;</label><input id="street-1" type="text" readonly /><br /><br />
        <label>&nbsp;&nbsp;&nbsp;Street Line2:&nbsp;</label><input id="street-2" type="text" readonly /><br /><br />
        <label>&nbsp;&nbsp;&nbsp;Number:&nbsp;</label><input id="street-number" type="text" readonly /><br /><br />
        <label>&nbsp;&nbsp;&nbsp;City:&nbsp;</label><input id="addr-city" type="text" readonly /><br /><br />
        <label>&nbsp;&nbsp;&nbsp;Province Or State:&nbsp;</label><input id="addr-state" type="text" readonly /><br /><br />
        <label>&nbsp;&nbsp;&nbsp;Country:&nbsp;</label><input id="addr-country" type="text" readonly /><br /><br />
        <label>&nbsp;&nbsp;&nbsp;GPS Co-ordinates:&nbsp;</label><input id="addr-gps" type="text" readonly /><br /><br />
        <label>&nbsp;&nbsp;&nbsp;Postal Code:&nbsp;</label><input id="addr-post-code" type="text" readonly /><br /><br />

        <label><strong>Primary Phone:&nbsp;</strong></label><button onclick="managePhoneNumbers()">Manage Phone Numbers</button><br /><br /><br /><br />
        <label>&nbsp;&nbsp;&nbsp;Country Code:&nbsp;</label><input id="phone-ctry-code" type="text" readonly /><br /><br />
        <label>&nbsp;&nbsp;&nbsp;Phone Number:&nbsp;</label><input id="phone-number" type="text" readonly /><br /><br />
        <label>&nbsp;&nbsp;&nbsp;Phone Features:&nbsp;</label><input id="phone-features" type="text" readonly /><br /><br />
        <label>&nbsp;&nbsp;&nbsp;Phone Type:&nbsp;</label><input id="phone-type" type="text" readonly /><br /><br />

        <label><strong>Profile Picture:&nbsp;</strong></label><button onclick="managePictures()">Manage Pictures</button><br /><br />
        <img id="current-picture" alt="Please upload an Image" width="300" height="300" /><br /><br />
        <label><strong>Service Categories:&nbsp;</strong></label><button onclick="manageServiceCategories()">Manage Service Categories</button><br /><br />

    </div>
    <br /><br />
    <button onclick="init();">Refresh</button>
    <br />
    
    <script>document.getElementById('theForm').onsubmit = function () {
            updateUserNames(
                document.getElementById('firstName').value,
                document.getElementById('middleNames').value,
                document.getElementById('lastName').value,
                init,
                onError);
            return false;
        };</script>

</body>
</html>